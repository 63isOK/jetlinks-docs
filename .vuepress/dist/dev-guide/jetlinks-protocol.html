<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JetLinks 消息协议 v1.0 | jetlinks系统文档</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/0.styles.6ebfbf8b.css" as="style"><link rel="preload" href="/assets/js/app.dc7074e4.js" as="script"><link rel="preload" href="/assets/js/2.910fdf72.js" as="script"><link rel="preload" href="/assets/js/54.4af39627.js" as="script"><link rel="prefetch" href="/assets/js/10.eda24268.js"><link rel="prefetch" href="/assets/js/11.19531054.js"><link rel="prefetch" href="/assets/js/12.4eab3e27.js"><link rel="prefetch" href="/assets/js/13.a47f45a1.js"><link rel="prefetch" href="/assets/js/14.3e730a46.js"><link rel="prefetch" href="/assets/js/15.907667c2.js"><link rel="prefetch" href="/assets/js/16.8015f92a.js"><link rel="prefetch" href="/assets/js/17.b5a8d997.js"><link rel="prefetch" href="/assets/js/18.1d62f5d1.js"><link rel="prefetch" href="/assets/js/19.9e6eee02.js"><link rel="prefetch" href="/assets/js/20.26bbcf10.js"><link rel="prefetch" href="/assets/js/21.e0709ae7.js"><link rel="prefetch" href="/assets/js/22.ce25e9cd.js"><link rel="prefetch" href="/assets/js/23.169aa2b6.js"><link rel="prefetch" href="/assets/js/24.8bd84257.js"><link rel="prefetch" href="/assets/js/25.d591de57.js"><link rel="prefetch" href="/assets/js/26.9df4e7f5.js"><link rel="prefetch" href="/assets/js/27.0b93dd99.js"><link rel="prefetch" href="/assets/js/28.93a3408e.js"><link rel="prefetch" href="/assets/js/29.09f1942e.js"><link rel="prefetch" href="/assets/js/3.98eadc90.js"><link rel="prefetch" href="/assets/js/30.cf5724ec.js"><link rel="prefetch" href="/assets/js/31.795834ec.js"><link rel="prefetch" href="/assets/js/32.624235db.js"><link rel="prefetch" href="/assets/js/33.396cc821.js"><link rel="prefetch" href="/assets/js/34.d98c87d8.js"><link rel="prefetch" href="/assets/js/35.f43eb095.js"><link rel="prefetch" href="/assets/js/36.113e2390.js"><link rel="prefetch" href="/assets/js/37.8e34b117.js"><link rel="prefetch" href="/assets/js/38.521e74ad.js"><link rel="prefetch" href="/assets/js/39.33750cb1.js"><link rel="prefetch" href="/assets/js/4.4d6e2213.js"><link rel="prefetch" href="/assets/js/40.9c2067e2.js"><link rel="prefetch" href="/assets/js/41.da1c1528.js"><link rel="prefetch" href="/assets/js/42.a86acc07.js"><link rel="prefetch" href="/assets/js/43.01ac982b.js"><link rel="prefetch" href="/assets/js/44.b29351ad.js"><link rel="prefetch" href="/assets/js/45.02dee7fb.js"><link rel="prefetch" href="/assets/js/46.31030732.js"><link rel="prefetch" href="/assets/js/47.d886bd46.js"><link rel="prefetch" href="/assets/js/48.2dafc81e.js"><link rel="prefetch" href="/assets/js/49.3cf2fd42.js"><link rel="prefetch" href="/assets/js/5.d9fe38f8.js"><link rel="prefetch" href="/assets/js/50.9e3340e3.js"><link rel="prefetch" href="/assets/js/51.f9bbad75.js"><link rel="prefetch" href="/assets/js/52.f3090553.js"><link rel="prefetch" href="/assets/js/53.131e43b9.js"><link rel="prefetch" href="/assets/js/55.332d5b71.js"><link rel="prefetch" href="/assets/js/56.468bb25a.js"><link rel="prefetch" href="/assets/js/57.5d23ec09.js"><link rel="prefetch" href="/assets/js/58.dbd31fff.js"><link rel="prefetch" href="/assets/js/59.52e0a5d6.js"><link rel="prefetch" href="/assets/js/6.e424fcf7.js"><link rel="prefetch" href="/assets/js/60.0adfc4b5.js"><link rel="prefetch" href="/assets/js/61.96074a66.js"><link rel="prefetch" href="/assets/js/62.7e859261.js"><link rel="prefetch" href="/assets/js/63.9503838f.js"><link rel="prefetch" href="/assets/js/64.04473a5c.js"><link rel="prefetch" href="/assets/js/65.6d5e6369.js"><link rel="prefetch" href="/assets/js/66.bebba830.js"><link rel="prefetch" href="/assets/js/7.078c9f18.js"><link rel="prefetch" href="/assets/js/8.616a6961.js"><link rel="prefetch" href="/assets/js/9.ba1a0650.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6ebfbf8b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">jetlinks系统文档</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="http://jetlinks.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jetlinks" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitee.com/jetlinks" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jetlinks/jetlinks-community/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  提交问题
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jetlinks/jetlinks-docs/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档纠错
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="http://jetlinks.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  关于
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jetlinks" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://gitee.com/jetlinks" target="_blank" rel="noopener noreferrer" class="nav-link external">
  gitee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jetlinks/jetlinks-community/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  提交问题
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/jetlinks/jetlinks-docs/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  文档纠错
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/basics-guide/course/introduction.html" class="sidebar-link">介绍</a></li><li><a href="/basics-guide/quick-start.html" class="sidebar-link">快速开始</a></li><li><a href="/basics-guide/course/system-layout.html" class="sidebar-link">系统配置</a></li><li><a href="/basics-guide/device-manager.html" class="sidebar-link">设备管理</a></li><li><a href="/basics-guide/course/network.html" class="sidebar-link">网络组件</a></li><li><a href="/basics-guide/course/notification.html" class="sidebar-link">通知管理</a></li><li><a href="/basics-guide/course/rule-engine.html" class="sidebar-link">规则引擎</a></li><li><a href="/basics-guide/course/logger.html" class="sidebar-link">日志管理</a></li><li><a href="/basics-guide/course/data-visualization.html" class="sidebar-link">数据可视化(Pro)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>进阶</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/advancement-guide/jetlinks-protocol.html" class="sidebar-link">JetLinks官方协议说明</a></li><li><a href="/basics-guide/protocol-support.html" class="sidebar-link">平台统一消息说明</a></li><li><a href="/advancement-guide/mqtt-connection.html" class="sidebar-link">使用MQTT服务网关接入设备</a></li><li><a href="/advancement-guide/third-mqtt.html" class="sidebar-link">通过第三方MQTT服务接入设备</a></li><li><a href="/advancement-guide/tcp-connection.html" class="sidebar-link">使用TCP服务网关接入设备</a></li><li><a href="/advancement-guide/children-device.html" class="sidebar-link">接入网关设备,并通过网关代理接入子设备</a></li><li><a href="/advancement-guide/rule-engine-subscription.html" class="sidebar-link">通过规则引擎订阅设备消息,处理后发送邮件通知</a></li><li><a href="/advancement-guide/rule-engine-send.html" class="sidebar-link">通过规则引擎向其他设备发送消息</a></li><li><a href="/advancement-guide/create-data-visualization.html" class="sidebar-link">创建可视化图表,实时展示设备属性变更(PRO)</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开发</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dev-guide/start.html" class="sidebar-link">介绍</a></li><li><a href="/dev-guide/specification.html" class="sidebar-link">规范</a></li><li><a href="/dev-guide/reactor.html" class="sidebar-link">响应式</a></li><li><a href="/dev-guide/crud.html" class="sidebar-link">增删改查</a></li><li><a href="/dev-guide/event-driver.html" class="sidebar-link">事件驱动之消息网关</a></li><li><a href="/dev-guide/custom-message-protocol.html" class="sidebar-link">自定义消息协议</a></li><li><a href="/dev-guide/custom-notification-component.html" class="sidebar-link">自定义通知组件</a></li><li><a href="/dev-guide/send-message.html" class="sidebar-link">向设备发送消息</a></li><li><a href="/dev-guide/custom-dashboard.html" class="sidebar-link">自定义仪表盘</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>常见问题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/common-problems/install.html" class="sidebar-link">安装,启动常见问题</a></li><li><a href="/common-problems/network-components.html" class="sidebar-link">网络组件常见问题</a></li><li><a href="/common-problems/mqtt-connection.html" class="sidebar-link">使用MQTT接入时的常见问题</a></li><li><a href="/common-problems/tcp-network-components.html" class="sidebar-link">TCP网络组件常见问题</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>HTTP接口文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/interface-guide/authentication.html" class="sidebar-link">权限设置</a></li><li><a href="/interface-guide/device/device-product.html" class="sidebar-link">设备型号</a></li><li><a href="/interface-guide/device/device-instance.html" class="sidebar-link">设备实例</a></li><li><a href="/" class="sidebar-link">网络组件</a></li><li><a href="/" class="sidebar-link">设备接入</a></li><li><a href="/" class="sidebar-link">消息通知</a></li><li><a href="/" class="sidebar-link">openApi</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jetlinks-消息协议-v1-0"><a href="#jetlinks-消息协议-v1-0" class="header-anchor">#</a> JetLinks 消息协议 v1.0</h1> <ul><li><a href="#%E8%AE%BE%E5%A4%87%E6%A8%A1%E5%9E%8B(%E5%85%83%E6%95%B0%E6%8D%AE)%E5%AE%9A%E4%B9%89">设备模型定义</a> <ul><li><a href="#%E5%B1%9E%E6%80%A7">属性</a></li> <li><a href="#%E5%8A%9F%E8%83%BD">功能</a></li> <li><a href="#%E4%BA%8B%E4%BB%B6">事件</a></li> <li><a href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B">数据类型</a></li></ul></li> <li><a href="#MQTT(S)%E6%8E%A5%E5%85%A5">MQTT接入</a> <ul><li><a href="#%E8%AE%A4%E8%AF%81">认证</a></li> <li><a href="#Topic">Topic</a></li></ul></li> <li><a href="#CoAP%E6%8E%A5%E5%85%A5">CoAP接入</a></li> <li><a href="#DTLS%E6%8E%A5%E5%85%A5">CoAP DTLS接入</a></li></ul> <h2 id="设备模型-元数据-定义"><a href="#设备模型-元数据-定义" class="header-anchor">#</a> 设备模型(元数据)定义</h2> <p>设备模型分为: 属性(properties),功能(function),事件(event).</p> <p>设备模型使用场景:</p> <ol><li>前端通过模型定义动态展示设备运行状态或者设备操作界面</li> <li>服务端可通过统一的API获取设备模型并进行相关操作,如: 在发送设备消息时进行参数校验,
在收到设备消息进行类型转换处理.</li></ol> <p>数据结构:</p> <pre><code>{
    &quot;id&quot;:&quot;设备ID&quot;,
    &quot;name&quot;:&quot;设备名称&quot;,
    &quot;properties&quot;:[...属性],
    &quot;functions&quot;:[...功能],
    &quot;events&quot;:[...事件]
}
</code></pre> <h3 id="属性"><a href="#属性" class="header-anchor">#</a> 属性</h3> <p>用于定义设备属性,运行状态等如: 设备SN,当前CPU使用率等.
平台可主动下发消息获取设备属性,设备也通过事件上报属性.</p> <p>数据结构:</p> <pre><code>{
   &quot;id&quot;: &quot;cpu_usage&quot;, //属性标识
   &quot;name&quot;: &quot;CPU使用率&quot;,
   &quot;valueType&quot;: {   //值类型
     &quot;type&quot;: &quot;double&quot;, //类型标识,见类型表
     &quot;maxValue&quot;:100,
     &quot;minValue&quot;:0,
     &quot;unit&quot;:&quot;percent&quot;,     //单位
     &quot;expands&quot;:{&quot;key1&quot;:&quot;value1&quot;} //其他自定义拓展定义
   },
   &quot;expands&quot;:{&quot;key1&quot;:&quot;value1&quot;} //其他自定义拓展定义
 }
</code></pre> <h3 id="功能"><a href="#功能" class="header-anchor">#</a> 功能</h3> <p>用于定义设备功能,平台可主动调用,例如: 播放语音,开关操作等.</p> <p>数据结构:</p> <pre><code>{
   &quot;id&quot;: &quot;playVoice&quot;, //功能标识
   &quot;name&quot;: &quot;播放声音&quot;, //名称
   &quot;inputs&quot;: [  //输入参数
     {
       &quot;id&quot;: &quot;text&quot;,
       &quot;name&quot;: &quot;文字内容&quot;,
       &quot;valueType&quot;: { //参数类型
         &quot;type&quot;: &quot;string&quot;
       },
       &quot;expands&quot;:{&quot;key1&quot;:&quot;value1&quot;} //其他自定义拓展定义
     }
   ],
   &quot;output&quot;: { //输出
     &quot;type&quot;: &quot;boolean&quot; //输出类型
   },
   &quot;expands&quot;:{&quot;key1&quot;:&quot;value1&quot;} //其他自定义拓展定义
 }
</code></pre> <h3 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h3> <p>用于定义设备事件, 如: 定时上报设备属性, 设备报警等.</p> <p>数据结构:</p> <pre><code>{
   &quot;id&quot;: &quot;fire_alarm&quot;, //事件标识
   &quot;name&quot;: &quot;火警&quot;,
   &quot;valueType&quot;: {
     &quot;type&quot;: &quot;object&quot;,  //对象(结构体)类型
     &quot;properties&quot;: [    //对象属性(结构与属性定义相同)
       {
         &quot;id&quot;: &quot;location&quot;,
         &quot;name&quot;: &quot;地点&quot;,
         &quot;valueType&quot;: {
           &quot;type&quot;: &quot;string&quot;
         }
       },
       {
         &quot;id&quot;: &quot;lng&quot;,
         &quot;name&quot;: &quot;经度&quot;,
         &quot;valueType&quot;: {
           &quot;type&quot;: &quot;double&quot;
         },
         &quot;expands&quot;:{&quot;gis&quot;:&quot;lng&quot;} //其他自定义拓展定义
       },
       {
         &quot;id&quot;: &quot;lat&quot;,
         &quot;name&quot;: &quot;纬度&quot;,
         &quot;valueType&quot;: {
           &quot;type&quot;: &quot;double&quot;
         },
          &quot;expands&quot;:{&quot;gis&quot;:&quot;lat&quot;} //其他自定义拓展定义
       }
     ]
   },
   &quot;expands&quot;:{&quot;key1&quot;:&quot;value1&quot;} //其他自定义拓展定义
}
</code></pre> <h3 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h3> <p>所有类型共有属性:</p> <ul><li>id 唯一标识</li> <li>name 名称</li> <li>description 描述</li> <li>expands 自定义配置</li></ul> <p>类型定义</p> <ol><li><p>int 整型</p></li> <li><p>long 长整型</p></li> <li><p>float 单精度浮点型</p></li> <li><p>double 双精度浮点型</p> <p>以上均为数字类型,共有属性:</p> <ul><li>max 最大值</li> <li>min 最小值</li> <li>unit 单位</li></ul> <p>例:</p> <pre><code> {
 &quot;type&quot;:&quot;double&quot;,
 &quot;max&quot;:100,
 &quot;min&quot;:0,
 &quot;unit&quot;:&quot;percent&quot;,
 &quot;expands&quot;:{&quot;readonly&quot;:true}
 }
</code></pre></li> <li><p>boolean 布尔类型</p> <p>属性</p> <ul><li>trueText 为true时的文本,默认为<code>是</code></li> <li>falseText 为false时的文本,默认为<code>否</code></li> <li>trueValue  为true时的值,默认为<code>true</code></li> <li>falseValue 为false时的值,默认为<code>false</code></li></ul> <p>例:</p> <pre><code> {
     &quot;type&quot;:&quot;boolean&quot;,
     &quot;trueText&quot;:&quot;开启&quot;,
     &quot;falseText&quot;:&quot;关闭&quot;,
     &quot;trueValue&quot;:&quot;1&quot;,
     &quot;falseValue&quot;:&quot;0&quot;
 }
</code></pre></li> <li><p>string 字符类型</p> <p>例:</p> <pre><code> {
    &quot;type&quot;:&quot;string&quot;,
    &quot;expands&quot;:{&quot;maxLen&quot;,&quot;255&quot;}
 }
</code></pre></li> <li><p>enum   枚举类型</p> <p>属性:</p> <ul><li>elements (Element)枚举中的元素</li></ul> <p>Element:</p> <ul><li>value 枚举值</li> <li>text 枚举文本</li> <li>description 说明</li></ul> <p>例:</p> <pre><code> {
     &quot;type&quot;:&quot;enum&quot;,
     &quot;elements&quot;:[
         {&quot;value&quot;:&quot;1&quot;,&quot;text&quot;:&quot;正常&quot;},
         {&quot;value&quot;:&quot;-1&quot;,&quot;text&quot;:&quot;警告&quot;},
         {&quot;value&quot;:&quot;0&quot;,&quot;text&quot;:&quot;未知&quot;}
     ]
 }
</code></pre></li> <li><p>date   时间类型</p> <p>属性:</p> <ul><li>format 格式,如: yyyy-MM-dd</li> <li>tz 时区,如: Asia/Shanghai</li></ul> <p>例:</p> <pre><code> {
     &quot;type&quot;:&quot;date&quot;,
     &quot;format&quot;:&quot;yyyy-MM-dd&quot;,
     &quot;tz&quot;: &quot;Asia/Shanghai&quot;
 }
</code></pre></li> <li><p>password 密码类型</p> <p>与string类型相同</p></li> <li><p>file    文件类型</p> <p>属性:</p> <ul><li>bodyType 类型: url,base64,binary</li></ul> <p>例:</p> <pre><code>{
   &quot;type&quot;:&quot;file&quot;,
   &quot;bodyType&quot;:&quot;url&quot;
}
</code></pre></li> <li><p>array 数组(集合)类型</p> <p>属性:</p> <ul><li>elementType 元素类型</li></ul> <p>例:</p> <pre><code>{
    &quot;type&quot;:&quot;array&quot;,
    &quot;elementType&quot;:{ 
        &quot;type&quot;:&quot;string&quot;
    }
}
</code></pre></li> <li><p>object  对象(结构体)类型</p> <p>属性:
- properties 属性列表</p> <p>例:</p> <pre><code>{
    &quot;type&quot;:&quot;object&quot;,
    &quot;properties&quot;:[
        {
         &quot;id&quot;: &quot;location&quot;,
         &quot;name&quot;: &quot;地点&quot;,
         &quot;valueType&quot;: {
           &quot;type&quot;: &quot;string&quot;
         }
       },
       {
         &quot;id&quot;: &quot;lng&quot;,
         &quot;name&quot;: &quot;经度&quot;,
         &quot;valueType&quot;: {
           &quot;type&quot;: &quot;double&quot;
         },
         &quot;expands&quot;:{&quot;gis&quot;:&quot;lng&quot;}
       },
       {
         &quot;id&quot;: &quot;lat&quot;,
         &quot;name&quot;: &quot;纬度&quot;,
         &quot;valueType&quot;: {
           &quot;type&quot;: &quot;double&quot;
         },
          &quot;expands&quot;:{&quot;gis&quot;:&quot;lat&quot;}
       }
    ]
}
</code></pre></li></ol> <h2 id="mqtt-s-接入"><a href="#mqtt-s-接入" class="header-anchor">#</a> MQTT(S)接入</h2> <p>目前支持MQTT3.1.1和3.1版本协议.</p> <h3 id="认证"><a href="#认证" class="header-anchor">#</a> 认证</h3> <p>CONNECT报文:</p> <div class="language- extra-class"><pre class="language-text"><code>clientId: 设备实例ID
username: secureId+&quot;|&quot;+timestamp
password: md5(secureId+&quot;|&quot;+timestamp+&quot;|&quot;+secureKey)
</code></pre></div><p>说明: <code>secureId</code>以及<code>secureKey</code>在创建设备产品和设备实例时进行配置.
<code>timestamp</code>为当前系统时间戳(毫秒),与系统时间不能相差5分钟.</p> <h3 id="topic"><a href="#topic" class="header-anchor">#</a> Topic</h3> <ul><li><p>读取设备属性:</p> <p>topic: <code>/{productId}/{deviceId}/properties/read</code></p> <p>方向: <code>下行</code></p> <p>消息格式:</p> <pre><code> {
 &quot;messageId&quot;:&quot;消息ID&quot;,
 &quot;deviceId&quot;:&quot;设备ID&quot;,
 &quot;properties&quot;:[&quot;sn&quot;,&quot;model&quot;] //要读取到属性列表
 }
</code></pre> <p>回复Topic: <code>/{productId}/{deviceId}/properties/read/reply</code></p> <p>回复消息格式:</p> <pre><code> //成功
 {
   &quot;messageId&quot;:&quot;与下行消息中的messageId相同&quot;,
   &quot;properties&quot;:{&quot;sn&quot;:&quot;test&quot;,&quot;model&quot;:&quot;test&quot;}, //key与设备模型中定义的属性id一致
   &quot;deviceId&quot;:&quot;设备ID&quot;,
   &quot;success&quot;:true,
 }
 //失败. 下同
 {
   &quot;messageId&quot;:&quot;与下行消息中的messageId相同&quot;,
   &quot;success&quot;:false,
   &quot;code&quot;:&quot;error_code&quot;,
   &quot;message&quot;:&quot;失败原因&quot;
 }
</code></pre></li> <li><p>修改设备属性:</p> <p>topic: <code>/{productId}/{deviceId}/properties/write</code></p> <p>消息格式:</p> <pre><code> {
  &quot;messageId&quot;:&quot;消息ID&quot;,
  &quot;deviceId&quot;:&quot;设备ID&quot;,
  &quot;properties&quot;:{&quot;color&quot;:&quot;red&quot;} //要设置的属性
 }
</code></pre> <p>回复Topic: <code>/{productId}/{deviceId}/properties/wirte/reply</code></p> <p>回复消息格式:</p> <pre><code> {
   &quot;messageId&quot;:&quot;与下行消息中的messageId相同&quot;,
   &quot;properties&quot;:{&quot;color&quot;:&quot;red&quot;}, //设置成功后的属性,可不返回
   &quot;success&quot;:true,
 }
</code></pre></li> <li><p>调用设备功能</p> <p>topic: <code>/{productId}/{deviceId}/function/invoke</code></p> <p>消息格式:</p> <pre><code>  {
   &quot;messageId&quot;:&quot;消息ID&quot;,
   &quot;deviceId&quot;:&quot;设备ID&quot;,
   &quot;function&quot;:&quot;playVoice&quot;,//功能ID
   &quot;inputs&quot;:[{&quot;name&quot;:&quot;text&quot;,&quot;value&quot;:&quot;播放声音&quot;}] //参数
  }
</code></pre> <p>回复Topic: <code>/{productId}/{deviceId}/function/invoke/reply</code></p> <p>回复消息格式:</p> <pre><code>  {
    &quot;messageId&quot;:&quot;与下行消息中的messageId相同&quot;,
    &quot;output&quot;:&quot;success&quot;, //返回执行结果
    &quot;success&quot;:true,
  }
</code></pre></li> <li><p>设备事件上报</p> <p>topic: /{productId}/{deviceId}/event/{eventId}</p> <p>消息格式:</p> <pre><code> {
 &quot;messageId&quot;:&quot;随机消息ID&quot;,
 &quot;data&quot;:100 //上报数据
 }
</code></pre> <p>拓展:</p> <p>定时上报属性:</p> <pre><code> {
 &quot;messageId&quot;:&quot;随机消息ID&quot;,
 &quot;data&quot;:{&quot;color&quot;:&quot;red&quot;},//属性列表
 &quot;headers&quot;:{&quot;report-properties&quot;:true} //标记为上报属性事件
 } 
</code></pre></li></ul> <h3 id="动态注册"><a href="#动态注册" class="header-anchor">#</a> 动态注册</h3> <p>暂不支持</p> <h2 id="coap接入"><a href="#coap接入" class="header-anchor">#</a> CoAP接入</h2> <p>使用CoAP协议接入仅需要对数据进行加密即可.加密算法: AES/ECB/PKCS5Padding.</p> <p>使用自定义Option: <code>2100:设备ID</code> 来标识设备.</p> <p>将请求体进行加密,密钥为在创建设备产品和设备实例时进行配置的(<code>secureKey</code>).</p> <p>请求地址(<code>URI</code>)与MQTT <code>Topic</code>相同.消息体(<code>payload</code>)与MQTT相同.</p> <h2 id="dtls接入"><a href="#dtls接入" class="header-anchor">#</a> DTLS接入</h2> <p>使用CoAP DTLS 协议接入时需要先进行认证:</p> <p>发送认证请求:</p> <div class="language-text extra-class"><pre class="language-text"><code>POST /auth
Accept: application/json
Content-Format: application/json
2100: 设备ID
2110: 签名 md5(payload+secureKey)
payload: {&quot;timestamp&quot;:&quot;时间戳&quot;}
</code></pre></div><p>响应结果:</p> <div class="language-text extra-class"><pre class="language-text"><code>2.05 (Content)
payload: {&quot;token&quot;:&quot;令牌&quot;}
</code></pre></div><p>之后的请求中需要将返回的令牌携带到自定义Option:2111</p> <p>例如:</p> <div class="language-text extra-class"><pre class="language-text"><code>POST /test/device1/event/fire_alarm
2100: 设备ID
2111: 令牌
...其他Option
payload: json数据
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.dc7074e4.js" defer></script><script src="/assets/js/2.910fdf72.js" defer></script><script src="/assets/js/54.4af39627.js" defer></script>
  </body>
</html>
